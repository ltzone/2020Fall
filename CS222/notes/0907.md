---
title: 【Algorithm】 Stable Matching
url: al-matching
date: 2020-09-07 14:19:52
tags: 
- 

categories: 
- 

---



<!--more-->

[toc]

## Problem



**Definition: Unstable Pair** `m` and `w` are unstable if
- `m` prefers `w` to its current
- `w` prefers `m` to its current
- i.e. can be improved

**Definition: Stable Pair** a perfect matching with no unstable pairs

> Hint: Try to define the problem from the opposite direction. (What is an unstable pair)

**Problem:** 


## Analysis

### Stable Roomate Problem

assign roommate pairs for `2n` people, stable matching doesn't always exists.

![](img/09-07-14-29-05.png)

is stable matching unique? not necessarily(四角恋)

![](img/09-07-14-30-16.png)

## Solution: Gale-Shapley

1. initialize empty matching `S`
2. while `some men are not proposed`
   1. `w = first woman on m`
   2. if `w` unmatched
      - add `(m,w)` to `S`
   3. else if `w` prefers `m` to current `m'`
      - remove `(m',w)` from `S`
      - add `(m,w)` to `S`
      - add `m'` to queue
3. return `S`

### Proof of correctness: Termination

**Observations**
1. Men propose to women in decreasing order of preference
2. Once a woman is matched, she never becomes unmatched

**Claim:** Algorithm terminates after at most $n^2$ iterations of while loop
**Proof.** Each time through the while loop a man proposes to a new woman. There are only $n^2$ possible proposals.
![](img/09-07-14-41-20.png)

### Proof of correctness: Perfection

> Hint: Prove by contradiction

**Claim:** In Gale-Shapley matching, all men and women get matched.
**Proof.**
- if a man is not matched upon termination of GS algorithm, 
- then some woman is never proposed
- but the man has proposed to all women
- contradiction


### Proof of correctnes: Stability

**Claim:** After GS Matching, there are no unstable pairs.
**Proof.**
- Suppose $S^*$ does not contain the pair $(A,Z)$